<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="759px" height="541px" viewBox="-0.5 -0.5 759 541" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2021-06-02T14:02:14.421Z&quot; agent=&quot;5.0 (X11)&quot; etag=&quot;NL7w8wg5ApTgSL1je4vb&quot; version=&quot;14.6.10&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;Pe7YsvQ30ZgYLdCuYZBm&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 279px; height: 1px; padding-top: 0px; margin-left: 5px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 540px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><h1><font style="font-size: 18px" face="Tahoma">Pseudocode</font></h1><p><br /></p><p><font face="Courier New"><font color="#0000CC">void</font> on_message_available():<br />    msg = receive_msg(); <font color="#006633">// pop msg</font><br />    <br /><font color="#006633">    // read message and determine <br />    // </font></font><font face="Courier New"><font color="#006633"><font face="Courier New"><font color="#006633">whether </font></font>we need to pop more <br />    // </font></font><font face="Courier New"><font color="#006633"><font face="Courier New"><font color="#006633">messages in order </font></font>to receive<br />    // the whole rpc call</font><br />    <br />    <font color="#FF0000">// soft stack overflow here</font><br /></font></p><p><br /><font face="Courier New"><font face="Courier New"><font color="#0000CC">void</font> on_pagefault():<br />    // pagefault in stack region<br />    // so we request a frame and map <br />    // </font></font><font face="Courier New"><font face="Courier New"><font face="Courier New"><font face="Courier New">it at </font></font>the faulting location<br />    rpc_call_get_frame();<br /></font></font></p><p><br /><font face="Courier New"><font face="Courier New"><font face="Courier New"><font face="Courier New"><font color="#0000CC">void</font> </font></font></font></font><font face="Courier New"><font face="Courier New"><font face="Courier New"><font face="Courier New"><font face="Courier New"><font face="Courier New">rpc_call_get_frame</font></font>():<br />    send_get_frame_message();</font></font></font></font><br /><font face="Courier New"><font face="Courier New"><font face="Courier New"><font face="Courier New"><font face="Courier New"><font face="Courier New"><font face="Courier New"><font face="Courier New">    <font color="#006633">// wait for response</font></font></font></font></font><br /><font color="#0000CC">    while</font>(!msg_available());<br />    response = </font></font></font></font><font face="Courier New"><font face="Courier New"><font face="Courier New"><font face="Courier New"><font face="Courier New">receive_msg();<br />    <br />   <font color="#006633"> // response is now the second part<br />    // of the original rpc call<br />    // instead of the response to our <br />    // ram request</font><br /></font></font></font></font></font></p></div></div></div></foreignObject><text x="5" y="12" fill="#000000" font-family="Helvetica" font-size="12px">Pseudocode...</text></switch></g><rect x="426.44" y="54.17" width="330.7" height="61.83" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="435.14" y="89.5" width="104.43" height="17.67" fill="#ffe6cc" stroke="#d79b00" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 102px; height: 1px; padding-top: 98px; margin-left: 436px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">RPC Call 0 (part 0)</div></div></div></foreignObject><text x="487" y="102" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">RPC Call 0 (part...</text></switch></g><rect x="539.57" y="89.5" width="104.43" height="17.67" fill="#ffe6cc" stroke="#d79b00" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 102px; height: 1px; padding-top: 98px; margin-left: 541px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">RPC Call 0 (part 1)</div></div></div></foreignObject><text x="592" y="102" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">RPC Call 0 (part...</text></switch></g><rect x="644" y="89.5" width="104.43" height="17.67" fill="#ffe6cc" stroke="#d79b00" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 102px; height: 1px; padding-top: 98px; margin-left: 645px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">RPC Call 0 (part 2)</div></div></div></foreignObject><text x="696" y="102" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">RPC Call 0 (part...</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 76px; height: 1px; padding-top: 70px; margin-left: 436px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><div>Message Queue</div></div></div></div></foreignObject><text x="474" y="74" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Message Queue</text></switch></g><path d="M 426.44 85.1 L 353.2 85.1 L 286.37 85.01" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 281.12 85 L 288.12 81.51 L 286.37 85.01 L 288.11 88.51 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 426.44 210.9 L 353.2 210.9 L 286.37 210.99" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 281.12 211 L 288.11 207.49 L 286.37 210.99 L 288.12 214.49 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="426.44" y="390" width="330.7" height="61.83" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="435.14" y="425.33" width="104.43" height="17.67" fill="#ffe6cc" stroke="#d79b00" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 102px; height: 1px; padding-top: 434px; margin-left: 436px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">RPC Call 0 (part 1)</div></div></div></foreignObject><text x="487" y="438" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">RPC Call 0 (part...</text></switch></g><rect x="539.57" y="425.33" width="104.43" height="17.67" fill="#ffe6cc" stroke="#d79b00" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 102px; height: 1px; padding-top: 434px; margin-left: 541px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">RPC Call 0 (part 2)</div></div></div></foreignObject><text x="592" y="438" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">RPC Call 0 (part...</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 76px; height: 1px; padding-top: 406px; margin-left: 436px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><div>Message Queue</div></div></div></div></foreignObject><text x="474" y="409" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Message Queue</text></switch></g><rect x="644" y="425.33" width="104.43" height="17.67" fill="#e1d5e7" stroke="#9673a6" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 102px; height: 1px; padding-top: 434px; margin-left: 645px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Response (frame)</div></div></div></foreignObject><text x="696" y="438" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Response (frame)</text></switch></g><path d="M 426.44 420.9 L 353.2 420.9 L 286.37 420.99" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 281.12 421 L 288.11 417.49 L 286.37 420.99 L 288.12 424.49 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="426.44" y="180" width="330.7" height="61.83" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="435.14" y="215.33" width="104.43" height="17.67" fill="#ffe6cc" stroke="#d79b00" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 102px; height: 1px; padding-top: 224px; margin-left: 436px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">RPC Call 0 (part 1)</div></div></div></foreignObject><text x="487" y="228" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">RPC Call 0 (part...</text></switch></g><rect x="539.57" y="215.33" width="104.43" height="17.67" fill="#ffe6cc" stroke="#d79b00" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 102px; height: 1px; padding-top: 224px; margin-left: 541px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">RPC Call 0 (part 2)</div></div></div></foreignObject><text x="592" y="228" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">RPC Call 0 (part...</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 76px; height: 1px; padding-top: 196px; margin-left: 436px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><div>Message Queue</div></div></div></div></foreignObject><text x="474" y="199" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Message Queue</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>